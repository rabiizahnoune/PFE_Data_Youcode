[2025-05-08T14:24:24.247+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: gold_pipeline.transform_gold_data manual__2025-05-08T14:23:55.540641+00:00 [queued]>
[2025-05-08T14:24:24.267+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: gold_pipeline.transform_gold_data manual__2025-05-08T14:23:55.540641+00:00 [queued]>
[2025-05-08T14:24:24.268+0000] {taskinstance.py:1359} INFO - Starting attempt 1 of 1
[2025-05-08T14:24:24.286+0000] {taskinstance.py:1380} INFO - Executing <Task(PythonOperator): transform_gold_data> on 2025-05-08 14:23:55.540641+00:00
[2025-05-08T14:24:24.293+0000] {standard_task_runner.py:57} INFO - Started process 8040 to run task
[2025-05-08T14:24:24.298+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'gold_pipeline', 'transform_gold_data', 'manual__2025-05-08T14:23:55.540641+00:00', '--job-id', '42', '--raw', '--subdir', 'DAGS_FOLDER/pipeline.py', '--cfg-path', '/tmp/tmpbs7o4q2p']
[2025-05-08T14:24:24.303+0000] {standard_task_runner.py:85} INFO - Job 42: Subtask transform_gold_data
[2025-05-08T14:24:24.365+0000] {task_command.py:415} INFO - Running <TaskInstance: gold_pipeline.transform_gold_data manual__2025-05-08T14:23:55.540641+00:00 [running]> on host 223a2d167166
[2025-05-08T14:24:24.473+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='gold_pipeline' AIRFLOW_CTX_TASK_ID='transform_gold_data' AIRFLOW_CTX_EXECUTION_DATE='2025-05-08T14:23:55.540641+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-05-08T14:23:55.540641+00:00'
[2025-05-08T14:24:24.475+0000] {client.py:724} INFO - Reading file '/gold_datalake/raw/gold_prices/2025-05-08.csv'.
[2025-05-08T14:24:24.513+0000] {client.py:724} INFO - Reading file '/gold_datalake/raw/fed_rates/2025-05-08.csv'.
[2025-05-08T14:24:24.539+0000] {client.py:724} INFO - Reading file '/gold_datalake/raw/sp500/2025-05-08.csv'.
[2025-05-08T14:24:24.578+0000] {logging_mixin.py:151} INFO - Dates uniques dans gold_df: <DatetimeArray>
['2025-04-08 00:00:00', '2025-04-08 04:00:00', '2025-04-08 08:00:00',
 '2025-04-08 12:00:00', '2025-04-08 16:00:00']
Length: 5, dtype: datetime64[ns]
[2025-05-08T14:24:24.579+0000] {logging_mixin.py:151} INFO - Dates uniques dans sp500_df: <DatetimeArray>
['2025-04-08 09:30:00', '2025-04-08 10:30:00', '2025-04-08 11:30:00',
 '2025-04-08 12:30:00', '2025-04-08 13:30:00']
Length: 5, dtype: datetime64[ns]
[2025-05-08T14:24:24.588+0000] {logging_mixin.py:151} INFO - Dates uniques dans sp500_4h: <DatetimeArray>
['2025-04-08 08:00:00', '2025-04-08 12:00:00', '2025-04-09 08:00:00',
 '2025-04-09 12:00:00', '2025-04-10 08:00:00']
Length: 5, dtype: datetime64[ns]
[2025-05-08T14:24:24.589+0000] {logging_mixin.py:151} INFO - Dates uniques dans calendar_df: <DatetimeArray>
['2025-04-08 00:00:00', '2025-04-08 04:00:00', '2025-04-08 08:00:00',
 '2025-04-08 12:00:00', '2025-04-08 16:00:00']
Length: 5, dtype: datetime64[ns]
[2025-05-08T14:24:24.604+0000] {logging_mixin.py:151} INFO - Colonnes dans merged_df: ['date', 'source_name', 'ticker_symbol', 'open_price', 'prix_or', 'volume_or', 'ingestion_timestamp', 'prix_sp500', 'volume_sp500', 'taux_fed']
[2025-05-08T14:24:24.605+0000] {logging_mixin.py:151} INFO - Taille de merged_df: (186, 10)
[2025-05-08T14:24:24.611+0000] {logging_mixin.py:151} INFO - Échantillon de merged_df:
                 date source_name ticker_symbol   open_price      prix_or  volume_or         ingestion_timestamp   prix_sp500  volume_sp500  taux_fed
0 2025-04-08 00:00:00    yfinance          GC=F  3008.600098  3018.000000    18916.0  2025-05-08T14:24:08.109088          NaN           NaN      4.33
1 2025-04-08 04:00:00    yfinance          GC=F  3017.699951  3034.100098    27702.0  2025-05-08T14:24:08.109151          NaN           NaN      4.33
2 2025-04-08 08:00:00    yfinance          GC=F  3034.199951  3016.000000    63689.0  2025-05-08T14:24:08.109197  5190.683268  1.025031e+09      4.33
3 2025-04-08 12:00:00    yfinance          GC=F  3015.800049  2999.100098    47138.0  2025-05-08T14:24:08.109241  5015.814941  2.399507e+09      4.33
4 2025-04-08 16:00:00    yfinance          GC=F  2998.899902  2991.800049     8421.0  2025-05-08T14:24:08.109285          NaN           NaN      4.33
[2025-05-08T14:24:24.616+0000] {logging_mixin.py:151} INFO - Taille de merged_df après dropna: (186, 10)
[2025-05-08T14:24:24.637+0000] {client.py:496} INFO - Writing to '/gold_datalake/processed/gold_prices_2025-05-08.parquet'.
[2025-05-08T14:24:24.689+0000] {logging_mixin.py:151} INFO - Fichier écrit avec succès dans HDFS: /gold_datalake/processed/gold_prices_2025-05-08.parquet
[2025-05-08T14:24:24.695+0000] {client.py:496} INFO - Writing to '/gold_datalake/processed/dim_date_2025-05-08.parquet'.
[2025-05-08T14:24:24.743+0000] {logging_mixin.py:151} INFO - Fichier écrit avec succès dans HDFS: /gold_datalake/processed/dim_date_2025-05-08.parquet
[2025-05-08T14:24:24.746+0000] {client.py:496} INFO - Writing to '/gold_datalake/processed/dim_marche_2025-05-08.parquet'.
[2025-05-08T14:24:24.789+0000] {logging_mixin.py:151} INFO - Fichier écrit avec succès dans HDFS: /gold_datalake/processed/dim_marche_2025-05-08.parquet
[2025-05-08T14:24:24.790+0000] {python.py:194} INFO - Done. Returned value was: (                date_id      prix_or  ...  variation_or_pct  variation_or_abs
0   2025-04-08 00:00:00  3018.000000  ...          0.000000          0.000000
1   2025-04-08 04:00:00  3034.100098  ...          0.533469         16.100098
2   2025-04-08 08:00:00  3016.000000  ...         -0.066269         -2.000000
3   2025-04-08 12:00:00  2999.100098  ...         -0.626239        -18.899902
4   2025-04-08 16:00:00  2991.800049  ...         -0.868123        -26.199951
..                  ...          ...  ...               ...               ...
181 2025-05-08 04:00:00  3404.199951  ...         12.796552        386.199951
182 2025-05-08 08:00:00  3404.199951  ...         12.796552        386.199951
183 2025-05-08 12:00:00  3404.199951  ...         12.796552        386.199951
184 2025-05-08 16:00:00  3404.199951  ...         12.796552        386.199951
185 2025-05-08 20:00:00  3404.199951  ...         12.796552        386.199951

[186 rows x 7 columns],                 date_id  jour  mois  annee  heure trimestre
0   2025-04-08 00:00:00     8     4   2025      0    2025Q2
1   2025-04-08 04:00:00     8     4   2025      4    2025Q2
2   2025-04-08 08:00:00     8     4   2025      8    2025Q2
3   2025-04-08 12:00:00     8     4   2025     12    2025Q2
4   2025-04-08 16:00:00     8     4   2025     16    2025Q2
..                  ...   ...   ...    ...    ...       ...
181 2025-05-08 04:00:00     8     5   2025      4    2025Q2
182 2025-05-08 08:00:00     8     5   2025      8    2025Q2
183 2025-05-08 12:00:00     8     5   2025     12    2025Q2
184 2025-05-08 16:00:00     8     5   2025     16    2025Q2
185 2025-05-08 20:00:00     8     5   2025     20    2025Q2

[186 rows x 6 columns],                 date_id  volume_sp500  marche_id
0   2025-04-08 00:00:00           NaN          1
1   2025-04-08 04:00:00           NaN          2
2   2025-04-08 08:00:00  1.025031e+09          3
3   2025-04-08 12:00:00  2.399507e+09          4
4   2025-04-08 16:00:00  2.122285e+09          5
..                  ...           ...        ...
181 2025-05-08 04:00:00  6.855398e+08        182
182 2025-05-08 08:00:00  4.905185e+08        183
183 2025-05-08 12:00:00  4.905185e+08        184
184 2025-05-08 16:00:00  4.905185e+08        185
185 2025-05-08 20:00:00  4.905185e+08        186

[186 rows x 3 columns])
[2025-05-08T14:24:24.859+0000] {taskinstance.py:1398} INFO - Marking task as SUCCESS. dag_id=gold_pipeline, task_id=transform_gold_data, execution_date=20250508T142355, start_date=20250508T142424, end_date=20250508T142424
[2025-05-08T14:24:24.910+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2025-05-08T14:24:24.944+0000] {taskinstance.py:2776} INFO - 1 downstream tasks scheduled from follow-on schedule check
