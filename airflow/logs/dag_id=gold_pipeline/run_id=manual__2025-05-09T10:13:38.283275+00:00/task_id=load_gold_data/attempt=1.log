[2025-05-09T10:14:32.955+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: gold_pipeline.load_gold_data manual__2025-05-09T10:13:38.283275+00:00 [queued]>
[2025-05-09T10:14:32.988+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: gold_pipeline.load_gold_data manual__2025-05-09T10:13:38.283275+00:00 [queued]>
[2025-05-09T10:14:32.993+0000] {taskinstance.py:1359} INFO - Starting attempt 1 of 1
[2025-05-09T10:14:33.029+0000] {taskinstance.py:1380} INFO - Executing <Task(PythonOperator): load_gold_data> on 2025-05-09 10:13:38.283275+00:00
[2025-05-09T10:14:33.035+0000] {standard_task_runner.py:57} INFO - Started process 1545 to run task
[2025-05-09T10:14:33.042+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'gold_pipeline', 'load_gold_data', 'manual__2025-05-09T10:13:38.283275+00:00', '--job-id', '54', '--raw', '--subdir', 'DAGS_FOLDER/pipeline.py', '--cfg-path', '/tmp/tmpg1hegij3']
[2025-05-09T10:14:33.046+0000] {standard_task_runner.py:85} INFO - Job 54: Subtask load_gold_data
[2025-05-09T10:14:33.111+0000] {task_command.py:415} INFO - Running <TaskInstance: gold_pipeline.load_gold_data manual__2025-05-09T10:13:38.283275+00:00 [running]> on host 749db00b1372
[2025-05-09T10:14:33.254+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='gold_pipeline' AIRFLOW_CTX_TASK_ID='load_gold_data' AIRFLOW_CTX_EXECUTION_DATE='2025-05-09T10:13:38.283275+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-05-09T10:13:38.283275+00:00'
[2025-05-09T10:14:36.049+0000] {logging_mixin.py:151} INFO - Permissions définies avec succès sur /gold_datalake/processed (777)
[2025-05-09T10:14:36.051+0000] {client.py:724} INFO - Reading file '/gold_datalake/processed/gold_prices_2025-05-09.parquet'.
[2025-05-09T10:14:36.119+0000] {logging_mixin.py:151} INFO - Fichier Parquet lu avec succès depuis HDFS: /gold_datalake/processed/gold_prices_2025-05-09.parquet
[2025-05-09T10:14:36.121+0000] {client.py:724} INFO - Reading file '/gold_datalake/processed/dim_date_2025-05-09.parquet'.
[2025-05-09T10:14:36.143+0000] {logging_mixin.py:151} INFO - Fichier Parquet lu avec succès depuis HDFS: /gold_datalake/processed/dim_date_2025-05-09.parquet
[2025-05-09T10:14:36.144+0000] {client.py:724} INFO - Reading file '/gold_datalake/processed/dim_marche_2025-05-09.parquet'.
[2025-05-09T10:14:36.166+0000] {logging_mixin.py:151} INFO - Fichier Parquet lu avec succès depuis HDFS: /gold_datalake/processed/dim_marche_2025-05-09.parquet
[2025-05-09T10:14:36.185+0000] {connection.py:314} INFO - Snowflake Connector for Python Version: 3.1.1, Python Version: 3.8.18, Platform: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.2.5
[2025-05-09T10:14:36.186+0000] {connection.py:1050} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-05-09T10:14:36.187+0000] {connection.py:1068} INFO - Setting use_openssl_only mode to False
[2025-05-09T10:14:36.845+0000] {cursor.py:804} INFO - query: [select current_database(), current_schema();]
[2025-05-09T10:14:36.953+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:36.954+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-09T10:14:36.956+0000] {cursor.py:804} INFO - query: [ROLLBACK]
[2025-05-09T10:14:37.043+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:37.044+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-09T10:14:37.045+0000] {cursor.py:804} INFO - query: [TRUNCATE TABLE GOLD_ANALYSIS.MARCHE.DIM_DATE]
[2025-05-09T10:14:37.207+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:37.209+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-09T10:14:37.215+0000] {cursor.py:804} INFO - query: [DESC TABLE /* sqlalchemy:_has_object */ "GOLD_ANALYSIS"."MARCHE"."DIM_DATE"]
[2025-05-09T10:14:37.312+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:37.314+0000] {cursor.py:959} INFO - Number of results in first chunk: 6
[2025-05-09T10:14:37.359+0000] {cursor.py:804} INFO - query: [INSERT INTO "GOLD_ANALYSIS"."MARCHE"."DIM_DATE" (date_id, jour, mois, annee, heu...]
[2025-05-09T10:14:38.407+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:38.409+0000] {cursor.py:804} INFO - query: [SHOW /* sqlalchemy:get_table_names */ TABLES IN "GOLD_ANALYSIS"."MARCHE"]
[2025-05-09T10:14:38.503+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:38.506+0000] {cursor.py:959} INFO - Number of results in first chunk: 3
[2025-05-09T10:14:38.508+0000] {logging_mixin.py:151} WARNING - /opt/***/dags/load.py:77 UserWarning: The provided table name 'DIM_DATE' is not found exactly as such in the database after writing the table, possibly due to case sensitivity issues. Consider using lower case table names.
[2025-05-09T10:14:38.509+0000] {cursor.py:804} INFO - query: [COMMIT]
[2025-05-09T10:14:38.719+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:38.720+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-09T10:14:38.720+0000] {logging_mixin.py:151} INFO - Table Dim_Date chargée avec succès dans Snowflake
[2025-05-09T10:14:38.721+0000] {cursor.py:804} INFO - query: [TRUNCATE TABLE GOLD_ANALYSIS.MARCHE.DIM_MARCHE]
[2025-05-09T10:14:38.893+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:38.894+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-09T10:14:38.898+0000] {cursor.py:804} INFO - query: [DESC TABLE /* sqlalchemy:_has_object */ "GOLD_ANALYSIS"."MARCHE"."DIM_MARCHE"]
[2025-05-09T10:14:38.988+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:38.991+0000] {cursor.py:959} INFO - Number of results in first chunk: 3
[2025-05-09T10:14:39.029+0000] {cursor.py:804} INFO - query: [INSERT INTO "GOLD_ANALYSIS"."MARCHE"."DIM_MARCHE" (date_id, volume_sp500, marche...]
[2025-05-09T10:14:39.609+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:39.612+0000] {cursor.py:804} INFO - query: [SHOW /* sqlalchemy:get_table_names */ TABLES IN "GOLD_ANALYSIS"."MARCHE"]
[2025-05-09T10:14:39.715+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:39.719+0000] {cursor.py:959} INFO - Number of results in first chunk: 3
[2025-05-09T10:14:39.728+0000] {logging_mixin.py:151} WARNING - /opt/***/dags/load.py:82 UserWarning: The provided table name 'DIM_MARCHE' is not found exactly as such in the database after writing the table, possibly due to case sensitivity issues. Consider using lower case table names.
[2025-05-09T10:14:39.730+0000] {cursor.py:804} INFO - query: [COMMIT]
[2025-05-09T10:14:39.942+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:39.943+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-09T10:14:39.944+0000] {logging_mixin.py:151} INFO - Table Dim_Marche chargée avec succès dans Snowflake
[2025-05-09T10:14:39.944+0000] {cursor.py:804} INFO - query: [TRUNCATE TABLE GOLD_ANALYSIS.MARCHE.FAIT_PRIX_OR]
[2025-05-09T10:14:40.097+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:40.098+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-09T10:14:40.103+0000] {cursor.py:804} INFO - query: [DESC TABLE /* sqlalchemy:_has_object */ "GOLD_ANALYSIS"."MARCHE"."FAIT_PRIX_OR"]
[2025-05-09T10:14:40.198+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:40.200+0000] {cursor.py:959} INFO - Number of results in first chunk: 7
[2025-05-09T10:14:40.241+0000] {cursor.py:804} INFO - query: [INSERT INTO "GOLD_ANALYSIS"."MARCHE"."FAIT_PRIX_OR" (date_id, prix_or, volume_or...]
[2025-05-09T10:14:40.733+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:40.735+0000] {cursor.py:804} INFO - query: [SHOW /* sqlalchemy:get_table_names */ TABLES IN "GOLD_ANALYSIS"."MARCHE"]
[2025-05-09T10:14:40.872+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:40.873+0000] {cursor.py:959} INFO - Number of results in first chunk: 3
[2025-05-09T10:14:40.875+0000] {logging_mixin.py:151} WARNING - /opt/***/dags/load.py:87 UserWarning: The provided table name 'FAIT_PRIX_OR' is not found exactly as such in the database after writing the table, possibly due to case sensitivity issues. Consider using lower case table names.
[2025-05-09T10:14:40.876+0000] {cursor.py:804} INFO - query: [COMMIT]
[2025-05-09T10:14:41.092+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:41.093+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-09T10:14:41.094+0000] {logging_mixin.py:151} INFO - Table Fait_Prix_Or chargée avec succès dans Snowflake
[2025-05-09T10:14:41.095+0000] {cursor.py:804} INFO - query: [ROLLBACK]
[2025-05-09T10:14:41.177+0000] {cursor.py:817} INFO - query execution done
[2025-05-09T10:14:41.178+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-09T10:14:41.179+0000] {logging_mixin.py:151} INFO - Connexion Snowflake fermée
[2025-05-09T10:14:41.180+0000] {python.py:194} INFO - Done. Returned value was: None
[2025-05-09T10:14:41.198+0000] {taskinstance.py:1398} INFO - Marking task as SUCCESS. dag_id=gold_pipeline, task_id=load_gold_data, execution_date=20250509T101338, start_date=20250509T101432, end_date=20250509T101441
[2025-05-09T10:14:41.243+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2025-05-09T10:14:41.259+0000] {taskinstance.py:2776} INFO - 0 downstream tasks scheduled from follow-on schedule check
