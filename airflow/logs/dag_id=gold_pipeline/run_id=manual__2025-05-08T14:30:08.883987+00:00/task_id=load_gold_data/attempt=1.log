[2025-05-08T14:31:11.264+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: gold_pipeline.load_gold_data manual__2025-05-08T14:30:08.883987+00:00 [queued]>
[2025-05-08T14:31:11.273+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: gold_pipeline.load_gold_data manual__2025-05-08T14:30:08.883987+00:00 [queued]>
[2025-05-08T14:31:11.273+0000] {taskinstance.py:1359} INFO - Starting attempt 1 of 1
[2025-05-08T14:31:11.287+0000] {taskinstance.py:1380} INFO - Executing <Task(PythonOperator): load_gold_data> on 2025-05-08 14:30:08.883987+00:00
[2025-05-08T14:31:11.294+0000] {standard_task_runner.py:57} INFO - Started process 681 to run task
[2025-05-08T14:31:11.298+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'gold_pipeline', 'load_gold_data', 'manual__2025-05-08T14:30:08.883987+00:00', '--job-id', '47', '--raw', '--subdir', 'DAGS_FOLDER/pipeline.py', '--cfg-path', '/tmp/tmpyx4chyfn']
[2025-05-08T14:31:11.302+0000] {standard_task_runner.py:85} INFO - Job 47: Subtask load_gold_data
[2025-05-08T14:31:11.349+0000] {task_command.py:415} INFO - Running <TaskInstance: gold_pipeline.load_gold_data manual__2025-05-08T14:30:08.883987+00:00 [running]> on host ab466a848054
[2025-05-08T14:31:11.448+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='gold_pipeline' AIRFLOW_CTX_TASK_ID='load_gold_data' AIRFLOW_CTX_EXECUTION_DATE='2025-05-08T14:30:08.883987+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-05-08T14:30:08.883987+00:00'
[2025-05-08T14:31:13.427+0000] {logging_mixin.py:151} INFO - Permissions définies avec succès sur /gold_datalake/processed (777)
[2025-05-08T14:31:13.428+0000] {client.py:724} INFO - Reading file '/gold_datalake/processed/gold_prices_2025-05-08.parquet'.
[2025-05-08T14:31:13.491+0000] {logging_mixin.py:151} INFO - Fichier Parquet lu avec succès depuis HDFS: /gold_datalake/processed/gold_prices_2025-05-08.parquet
[2025-05-08T14:31:13.492+0000] {client.py:724} INFO - Reading file '/gold_datalake/processed/dim_date_2025-05-08.parquet'.
[2025-05-08T14:31:13.512+0000] {logging_mixin.py:151} INFO - Fichier Parquet lu avec succès depuis HDFS: /gold_datalake/processed/dim_date_2025-05-08.parquet
[2025-05-08T14:31:13.513+0000] {client.py:724} INFO - Reading file '/gold_datalake/processed/dim_marche_2025-05-08.parquet'.
[2025-05-08T14:31:13.533+0000] {logging_mixin.py:151} INFO - Fichier Parquet lu avec succès depuis HDFS: /gold_datalake/processed/dim_marche_2025-05-08.parquet
[2025-05-08T14:31:13.547+0000] {connection.py:314} INFO - Snowflake Connector for Python Version: 3.1.1, Python Version: 3.8.18, Platform: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.2.5
[2025-05-08T14:31:13.549+0000] {connection.py:1050} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-05-08T14:31:13.549+0000] {connection.py:1068} INFO - Setting use_openssl_only mode to False
[2025-05-08T14:31:15.159+0000] {cursor.py:804} INFO - query: [select current_database(), current_schema();]
[2025-05-08T14:31:15.282+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:15.283+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-08T14:31:15.304+0000] {cursor.py:804} INFO - query: [ROLLBACK]
[2025-05-08T14:31:15.402+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:15.403+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-08T14:31:15.404+0000] {cursor.py:804} INFO - query: [TRUNCATE TABLE GOLD_ANALYSIS.MARCHE.Dim_Date]
[2025-05-08T14:31:15.637+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:15.637+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-08T14:31:15.641+0000] {cursor.py:804} INFO - query: [DESC TABLE /* sqlalchemy:_has_object */ "GOLD_ANALYSIS"."MARCHE"."Dim_Date"]
[2025-05-08T14:31:15.742+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:15.755+0000] {cursor.py:804} INFO - query: [CREATE TABLE "GOLD_ANALYSIS"."MARCHE"."Dim_Date" ( date_id datetime, jour INTEGE...]
[2025-05-08T14:31:16.076+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:16.077+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-08T14:31:18.827+0000] {cursor.py:804} INFO - query: [INSERT INTO "GOLD_ANALYSIS"."MARCHE"."Dim_Date" (date_id, jour, mois, annee, heu...]
[2025-05-08T14:31:20.386+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:20.389+0000] {cursor.py:804} INFO - query: [SHOW /* sqlalchemy:get_table_names */ TABLES IN "GOLD_ANALYSIS"."MARCHE"]
[2025-05-08T14:31:20.492+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:20.495+0000] {cursor.py:959} INFO - Number of results in first chunk: 4
[2025-05-08T14:31:20.496+0000] {cursor.py:804} INFO - query: [COMMIT]
[2025-05-08T14:31:20.698+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:20.699+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-08T14:31:20.700+0000] {logging_mixin.py:151} INFO - Table Dim_Date chargée avec succès dans Snowflake
[2025-05-08T14:31:20.700+0000] {cursor.py:804} INFO - query: [TRUNCATE TABLE GOLD_ANALYSIS.MARCHE.Dim_Marche]
[2025-05-08T14:31:20.843+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:20.844+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-08T14:31:20.846+0000] {cursor.py:804} INFO - query: [DESC TABLE /* sqlalchemy:_has_object */ "GOLD_ANALYSIS"."MARCHE"."Dim_Marche"]
[2025-05-08T14:31:20.930+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:20.933+0000] {cursor.py:804} INFO - query: [CREATE TABLE "GOLD_ANALYSIS"."MARCHE"."Dim_Marche" ( date_id datetime, volume_sp...]
[2025-05-08T14:31:21.172+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:21.173+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-08T14:31:21.183+0000] {cursor.py:804} INFO - query: [INSERT INTO "GOLD_ANALYSIS"."MARCHE"."Dim_Marche" (date_id, volume_sp500, marche...]
[2025-05-08T14:31:21.607+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:21.608+0000] {cursor.py:804} INFO - query: [SHOW /* sqlalchemy:get_table_names */ TABLES IN "GOLD_ANALYSIS"."MARCHE"]
[2025-05-08T14:31:21.709+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:21.710+0000] {cursor.py:959} INFO - Number of results in first chunk: 5
[2025-05-08T14:31:21.711+0000] {cursor.py:804} INFO - query: [COMMIT]
[2025-05-08T14:31:21.900+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:21.901+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-08T14:31:21.901+0000] {logging_mixin.py:151} INFO - Table Dim_Marche chargée avec succès dans Snowflake
[2025-05-08T14:31:21.902+0000] {cursor.py:804} INFO - query: [TRUNCATE TABLE GOLD_ANALYSIS.MARCHE.Fait_Prix_Or]
[2025-05-08T14:31:22.089+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:22.089+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-08T14:31:22.091+0000] {cursor.py:804} INFO - query: [DESC TABLE /* sqlalchemy:_has_object */ "GOLD_ANALYSIS"."MARCHE"."Fait_Prix_Or"]
[2025-05-08T14:31:22.176+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:22.182+0000] {cursor.py:804} INFO - query: [CREATE TABLE "GOLD_ANALYSIS"."MARCHE"."Fait_Prix_Or" ( date_id datetime, prix_or...]
[2025-05-08T14:31:22.431+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:22.432+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-08T14:31:22.457+0000] {cursor.py:804} INFO - query: [INSERT INTO "GOLD_ANALYSIS"."MARCHE"."Fait_Prix_Or" (date_id, prix_or, volume_or...]
[2025-05-08T14:31:22.944+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:22.945+0000] {cursor.py:804} INFO - query: [SHOW /* sqlalchemy:get_table_names */ TABLES IN "GOLD_ANALYSIS"."MARCHE"]
[2025-05-08T14:31:23.049+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:23.050+0000] {cursor.py:959} INFO - Number of results in first chunk: 6
[2025-05-08T14:31:23.051+0000] {cursor.py:804} INFO - query: [COMMIT]
[2025-05-08T14:31:23.228+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:23.229+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-08T14:31:23.230+0000] {logging_mixin.py:151} INFO - Table Fait_Prix_Or chargée avec succès dans Snowflake
[2025-05-08T14:31:23.230+0000] {cursor.py:804} INFO - query: [ROLLBACK]
[2025-05-08T14:31:23.314+0000] {cursor.py:817} INFO - query execution done
[2025-05-08T14:31:23.315+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-05-08T14:31:23.316+0000] {logging_mixin.py:151} INFO - Connexion Snowflake fermée
[2025-05-08T14:31:23.318+0000] {python.py:194} INFO - Done. Returned value was: None
[2025-05-08T14:31:23.337+0000] {taskinstance.py:1398} INFO - Marking task as SUCCESS. dag_id=gold_pipeline, task_id=load_gold_data, execution_date=20250508T143008, start_date=20250508T143111, end_date=20250508T143123
[2025-05-08T14:31:23.384+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2025-05-08T14:31:23.410+0000] {taskinstance.py:2776} INFO - 0 downstream tasks scheduled from follow-on schedule check
